<div class="bg-white rounded-xl overflow-hidden shadow-[0_1px_3px_rgba(0,0,0,0.1)] p-4">
  <table mat-table [dataSource]="dataSource" class="w-full border-collapse">
    @for (column of columns; track column.key) {
      <ng-container [matColumnDef]="column.key">
        <th
          mat-header-cell
          *matHeaderCellDef
          class="p-4 px-6 text-left text-xs font-semibold text-[#6B7280] uppercase tracking-wider bg-[#F9FAFB] border-b border-[#E5E7EB]"
        >
          {{ column.label }}
        </th>
        <td
          mat-cell
          *matCellDef="let row"
          class="py-5 px-6 text-[#374151] text-sm border-b border-[#F3F4F6] transition-colors duration-200"
        >
          @if (column.type === 'avatar') {
            <div class="flex items-center gap-4 py-3">
              <div
                class="w-10 h-10 rounded-lg flex items-center justify-center font-semibold text-sm shrink-0"
                [style.background-color]="getAvatarColor(row[column.key])"
              >
                <span [style.color]="getTextColor(getAvatarColor(row[column.key]))">{{
                  getInitials(row[column.key])
                }}</span>
              </div>
              <div class="flex flex-col gap-0.5">
                <div class="font-semibold text-[#111827]">{{ row[column.key] }}</div>
                @if (row['id']) {
                  <div class="text-xs text-[#9CA3AF]">ID: {{ row['id'] }}</div>
                }
              </div>
            </div>
          } @else if (column.type === 'product-name') {
            <div class="flex items-center gap-3">
              <span class="material-icons text-[#9CA3AF] text-xl">checkroom</span>
              <span class="font-semibold text-[#111827]">{{ row[column.key] }}</span>
            </div>
          } @else if (column.type === 'stock') {
            <div class="flex items-center gap-2">
              @if (row['stockStatus'] === 'out') {
                <div
                  class="flex items-center gap-2 bg-[#FEE2E2] text-[#B91C1C] px-3 py-1 rounded text-xs font-medium"
                >
                  <span class="font-bold">{{ row['stockValue'] }}</span>
                  <span class="uppercase">Out of Stock</span>
                </div>
              } @else if (row['stockStatus'] === 'low') {
                <div class="flex items-center gap-2">
                  <span class="font-bold text-[#111827]">{{ row['stockValue'] }}</span>
                  <span class="material-icons text-[#F59E0B] text-base">warning</span>
                  <span class="text-[#F59E0B] text-xs">Low Stock</span>
                </div>
              } @else {
                <div class="flex items-center gap-2">
                  <span class="font-bold text-[#111827]">{{ row['stockValue'] }}</span>
                  <span class="w-2 h-2 rounded-full bg-[#10B981]"></span>
                </div>
              }
            </div>
          } @else if (column.type === 'badge') {
            <span
              class="inline-block py-1.5 px-3 rounded-md text-xs font-medium"
              [style.background-color]="row[column.colorField || 'roleColor'] || '#E0E7FF'"
              [style.color]="
                row[
                  column.colorField
                    ? column.colorField.replace('Color', 'TextColor')
                    : 'roleTextColor'
                ] || '#6366F1'
              "
            >
              {{ row[column.key] }}
            </span>
          } @else if (column.type === 'status') {
            <div class="flex items-center gap-2">
              <span
                class="w-2 h-2 rounded-full bg-[#D1D5DB]"
                [class.!bg-[#1bd861]]="row[column.key] === 'Active'"
              ></span>
              <span>{{ row[column.key] }}</span>
            </div>
          } @else if (column.type === 'actions') {
            <div class="flex gap-2">
              @for (action of actions; track action.label) {
                @if (!action.condition || action.condition(row)) {
                  @if (action.icon) {
                    <button
                      class="p-2 hover:bg-[#F3F4F6] rounded-md cursor-pointer transition-all duration-200"
                      (click)="action.callback(row)"
                      [style.color]="action.textColor || '#9CA3AF'"
                    >
                      <span class="material-icons text-xl">{{ action.icon }}</span>
                    </button>
                  } @else {
                    <button
                      class="py-2 px-3.5 border border-[#E5E7EB] rounded-md text-sm text-white cursor-pointer transition-all duration-200 font-medium hover:border-[#D1D5DB]"
                      (click)="action.callback(row)"
                      [style.background-color]="action.bgColor || '#1D4ED8'"
                      [style.color]="action.textColor || '#ffffff'"
                      [style.border-color]="action.bgColor ? action.bgColor : '#E5E7EB'"
                    >
                      {{ action.label }}
                    </button>
                  }
                }
              }
            </div>
          } @else {
            <span>{{ row[column.key] }}</span>
          }
        </td>
      </ng-container>
    }

    <tr mat-header-row *matHeaderRowDef="displayedColumns" class="hover:bg-[#F9FAFB]"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
  </table>

  <mat-paginator
    [pageSizeOptions]="[5, 10, 20]"
    [pageSize]="5"
    showFirstLastButtons
    class="flex justify-between items-center p-4 px-6 border-t border-[#F3F4F6]"
  >
  </mat-paginator>
</div>
